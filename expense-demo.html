<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Business Detail | BPMS</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal","Nirmala UI",system-ui,Arial;
  background:#f4f7f6;
  margin:0;
}
.wrap{
  max-width:900px;
  margin:25px auto;
  background:#fff;
  padding:25px;
  border-radius:10px;
}
h2{margin-top:0;color:#2e7d32}

/* ===== PROGRESS ===== */
.progress{
  background:#e8f5e9;
  border:1px solid #c8e6c9;
  padding:12px;
  border-radius:8px;
  margin-bottom:15px;
}
.steps span{
  padding:4px 8px;
  border-radius:10px;
  background:#eee;
  font-size:13px;
}
.steps .done{background:#a5d6a7}
.steps .active{background:#2e7d32;color:#fff}
.bar{
  height:8px;
  background:#ddd;
  border-radius:6px;
  overflow:hidden;
  margin-top:8px;
}
.bar span{
  display:block;
  height:100%;
  width:29%;
  background:#2e7d32;
}

/* ===== FORM ===== */
label{font-weight:700}
input,textarea{
  width:100%;
  padding:8px;
  margin:6px 0 12px;
  font-family:inherit;
}
textarea{min-height:90px}

/* ===== TOPIC BLOCK ===== */
.block{
  border-left:4px solid #2e7d32;
  background:#f9fdf9;
  padding:12px;
  margin-top:12px;
  border-radius:6px;
}
.block h4{margin:0 0 6px}
.del{
  background:#c62828;
  color:#fff;
  border:none;
  padding:4px 8px;
  border-radius:4px;
  cursor:pointer;
}

/* ===== NAV ===== */
.nav{
  display:flex;
  justify-content:space-between;
  margin-top:25px;
}
button{
  padding:8px 16px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  background:#2e7d32;
  color:#fff;
}

@media print{
  button,.progress{display:none}
}
</style>
</head>

<body>

<div class="wrap">

<!-- ===== PROGRESS ===== -->
<div class="progress">
  <b>‡§ö‡§∞‡§£ 2 / 7</b><br><br>
  <div class="steps">
    <span class="done">Short Info</span> ‚Üí
    <span class="active">Detail</span> ‚Üí
    <span>Expense</span> ‚Üí
    <span>Income</span> ‚Üí
    <span>Profit</span> ‚Üí
    <span>ROI</span> ‚Üí
    <span>Proposal</span>
  </div>
  <div class="bar"><span></span></div>
</div>

<h2>üìã ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø / ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ‡§ï‡•ã ‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£</h2>
<div id="saveStatus">‚úî Saved</div>

<label>‡§µ‡§ø‡§∑‡§Ø‡§ó‡§§ ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï</label>
<input id="topic" placeholder="‡§ú‡§∏‡•ç‡§§‡•à: ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ï‡•ã ‡§™‡•É‡§∑‡•ç‡§†‡§≠‡•Ç‡§Æ‡§ø">

<label>‡§µ‡§ø‡§µ‡§∞‡§£</label>
<textarea id="content" placeholder="‡§Ø‡§∏ ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï ‡§Ö‡§®‡•ç‡§§‡§∞‡•ç‡§ó‡§§‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≤‡•á‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç"></textarea>

<button onclick="addSection()">‚ûï Add Section</button>

<div id="sectionList"></div>

<div class="nav">
  <button onclick="goPrev()">‚¨Ö Previous</button>
  <button onclick="goNext()">Next ‚û°</button>
</div>

</div>

<script>
/* ===== LOAD PROJECT ===== */
let key = localStorage.getItem("activeProject");
if(!key){
  alert("‡§™‡§π‡§ø‡§≤‡•á Project ‡§ñ‡•ã‡§≤‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç");
  location.href="index.html";
}
let project = JSON.parse(localStorage.getItem(key));
let details = project.businessDetail || [];

/* ===== RENDER ===== */
function render(){
  sectionList.innerHTML="";
  details.forEach((d,i)=>{
    sectionList.innerHTML+=`
      <div class="block">
        <h4>${d.topic}</h4>
        <p>${d.content}</p>
        <button class="del" onclick="remove(${i})">Delete</button>
      </div>`;
  });
}
render();

/* ===== ADD ===== */
function addSection(){
  if(!topic.value && !content.value) return;
  details.push({topic:topic.value,content:content.value});
  topic.value=""; content.value="";
  save();
}

/* ===== REMOVE ===== */
function remove(i){
  details.splice(i,1);
  save();
}

/* ===== SAVE ===== */
function save(){
  project.businessDetail=details;
  project.lastEdited=new Date().toLocaleString("ne-NP");
  localStorage.setItem(key,JSON.stringify(project));
  saveStatus.innerText="‚úî Saved";
  render();
}

/* ===== FINAL LOCK ===== */
if(project.status==="final"){
  document.querySelectorAll("input,textarea,button").forEach(b=>{
    if(b.innerText.includes("Previous")||b.innerText.includes("Next")) return;
    b.disabled=true;
    b.style.opacity=.6;
  });
}

/* ===== NAV ===== */
function goPrev(){location.href="short-info.html";}
function goNext(){save();location.href="expense-demo.html";}
</script>

</body>
</html>
