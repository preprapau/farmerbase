<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>farmerbase тАУ рел рд╡рд░реНрд╖реЗ рд╡рд┐рддреНрддреАрдп рдкреНрд░рдХреНрд╖реЗрдкрдг рддрдерд╛ ROI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:
   "Noto Sans Devanagari",
   "Kalimati",
   "Mangal",
   "Nirmala UI",
   system-ui,
   Arial,
   sans-serif;
  background:#f4f7f6;
  margin:0;
}
header{
  background:#2e7d32;
  color:#fff;
  padding:22px;
  text-align:center;
}
main{
  max-width:1100px;
  margin:20px auto;
  background:#fff;
  padding:25px;
  border-radius:10px;
}
h2{color:#2e7d32;margin-top:30px}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td{
  border:1px solid #ccc;
  padding:10px;
  text-align:right;
}
th{
  background:#eef6f0;
  text-align:center;
}
td.left{text-align:left}
.highlight{
  background:#eef6f0;
  font-weight:700;
}
.note{
  background:#eef6f0;
  padding:15px;
  margin-top:25px;
  border-left:5px solid #2e7d32;
}
footer{
  text-align:center;
  font-size:13px;
  color:#555;
  padding:15px;
}
input{
  padding:6px;
  width:200px;
}
</style>
</head>

<body>
<header>
<h1>ЁЯМ╛ farmerbase тАУ рел рд╡рд░реНрд╖реЗ рд╡рд┐рддреНрддреАрдп рдкреНрд░рдХреНрд╖реЗрдкрдг</h1>
<p>Payback Period рддрдерд╛ ROI (Live-Linked)</p>
</header>

<main>

<h2>ЁЯФв рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рд▓рдЧрд╛рдиреА</h2>
<p>рдпрд╕рдорд╛ рднрд╡рди, рдореЗрд╢рд┐рди, рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рдкрд╢реБ/рдмреАрдЙ, рдкреВрд░реНрд╡рд╛рдзрд╛рд░ рдЖрджрд┐ рд╕рдорд╛рд╡реЗрд╢ рд╣реБрдиреНрдЫред</p>
<input type="number" id="investment" placeholder="рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рд▓рдЧрд╛рдиреА (рд░реБ.)" oninput="calculate()" />

<h2>ЁЯУК рел рд╡рд░реНрд╖реЗ рдирдЧрдж рдкреНрд░рд╡рд╛рд╣ (Cash Flow Projection)</h2>

<table>
<thead>
<tr>
  <th>рд╡рд░реНрд╖</th>
  <th>рд╡рд╛рд░реНрд╖рд┐рдХ рдЖрдореНрджрд╛рдиреА (рд░реБ.)</th>
  <th>рд╡рд╛рд░реНрд╖рд┐рдХ рдЦрд░реНрдЪ (рд░реБ.)</th>
  <th>рд╡рд╛рд░реНрд╖рд┐рдХ рдирд╛рдлрд╛ (рд░реБ.)</th>
  <th>рд╕рдВрдЪрд┐рдд рдирдЧрдж рдкреНрд░рд╡рд╛рд╣ (рд░реБ.)</th>
</tr>
</thead>
<tbody id="projectionBody"></tbody>
</table>

<h2>ЁЯУИ рд▓рдЧрд╛рдиреА рдкреНрд░рддрд┐рдлрд▓ рд╡рд┐рд╢реНрд▓реЗрд╖рдг</h2>

<table>
<tr>
  <td class="left highlight">рдХреБрд▓ рел рд╡рд░реНрд╖рдХреЛ рдирд╛рдлрд╛</td>
  <td class="highlight">рд░реБ. <span id="totalProfit">0</span></td>
</tr>
<tr>
  <td class="left highlight">Payback Period</td>
  <td class="highlight"><span id="payback">тАФ</span></td>
</tr>
<tr>
  <td class="left highlight">ROI (%)</td>
  <td class="highlight"><span id="roi">тАФ</span></td>
</tr>
</table>

<div class="note" id="analysisText"></div>

<!-- Debug -->
<div style="margin-top:15px;font-size:13px;color:#555">
  <strong>Debug:</strong>
  Expense=<span id="dExp"></span> |
  Income=<span id="dInc"></span>
</div>

</main>

<footer>
┬й farmerbase BPMS Demo | 5-Year Projection & ROI
</footer>

<script>
function calculate(){
  let expense = Number(localStorage.getItem("totalExpense")) || 0;
  let income  = Number(localStorage.getItem("totalIncome")) || 0;
  let profit  = income - expense;
  let invest  = Number(document.getElementById("investment").value) || 0;

  document.getElementById("dExp").innerText = expense;
  document.getElementById("dInc").innerText = income;

  let body = document.getElementById("projectionBody");
  body.innerHTML = "";

  let cumulative = -invest;
  let totalProfit = 0;
  let paybackYear = "рдирднрдПрдХреЛ";

  for(let y=1; y<=5; y++){
    cumulative += profit;
    totalProfit += profit;

    if(cumulative >= 0 && paybackYear === "рдирднрдПрдХреЛ"){
      paybackYear = "рд╡рд░реНрд╖ " + y;
    }

    body.innerHTML += `
      <tr>
        <td class="left">рд╡рд░реНрд╖ ${y}</td>
        <td>${income.toLocaleString()}</td>
        <td>${expense.toLocaleString()}</td>
        <td>${profit.toLocaleString()}</td>
        <td>${cumulative.toLocaleString()}</td>
      </tr>
    `;
  }

  document.getElementById("totalProfit").innerText =
    totalProfit.toLocaleString();

  document.getElementById("payback").innerText = paybackYear;

  if(invest > 0){
    let roi = (totalProfit / invest) * 100;
    document.getElementById("roi").innerText =
      roi.toFixed(2) + " %";
  }else{
    document.getElementById("roi").innerText = "тАФ";
  }

  document.getElementById("analysisText").innerText =
    `рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╡реНрдпрд╡рд╕рд╛рдпрдмрд╛рдЯ рел рд╡рд░реНрд╖рдХреЛ рдЕрд╡рдзрд┐рдорд╛ рдХреБрд▓ рд░реБ. ${totalProfit.toLocaleString()}
     рдирд╛рдлрд╛ рдЖрд░реНрдЬрди рд╣реБрдиреЗ рджреЗрдЦрд┐рдПрдХреЛ рдЫред рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рд▓рдЧрд╛рдиреАрдХреЛ Payback ${paybackYear}
     рдорд╛ рд╣реБрдиреЗ рддрдерд╛ рдХреБрд▓ ROI ${invest>0 ? ((totalProfit/invest)*100).toFixed(2) : 0}% рд░рд╣рдиреЗ
     рдкреНрд░рдХреНрд╖реЗрдкрдг рдЧрд░рд┐рдПрдХреЛ рдЫред`;
}

window.onload = calculate;
</script>

</body>
</html>
