<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>farmerbase тАУ рел рд╡рд░реНрд╖реЗ рд╡рд┐рддреНрддреАрдп рдкреНрд░рдХреНрд╖реЗрдкрдг рддрдерд╛ ROI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:
   "Noto Sans Devanagari",
   "Kalimati",
   "Mangal",
   "Nirmala UI",
   system-ui,
   Arial,
   sans-serif;
  background:#f4f7f6;
  margin:0;
}
header{
  background:#2e7d32;
  color:#fff;
  padding:22px;
  text-align:center;
}
main{
  max-width:1100px;
  margin:20px auto;
  background:#fff;
  padding:25px;
  border-radius:10px;
}
h2,h3{color:#2e7d32;margin-top:30px}
table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td{
  border:1px solid #ccc;
  padding:10px;
  text-align:right;
}
th{
  background:#eef6f0;
  text-align:center;
}
td.left{text-align:left}
.highlight{
  background:#eef6f0;
  font-weight:700;
}
.note{
  background:#eef6f0;
  padding:15px;
  margin-top:25px;
  border-left:5px solid #2e7d32;
}
input{
  padding:8px;
  width:220px;
  margin-top:6px;
}
.footer-note{
  font-size:13px;
  color:#555;
  margin-top:10px;
}
footer{
  text-align:center;
  font-size:13px;
  color:#555;
  padding:15px;
}
</style>
</head>

<body>
<header>
<h1>ЁЯМ╛ farmerbase тАУ рел рд╡рд░реНрд╖реЗ рд╡рд┐рддреНрддреАрдп рдкреНрд░рдХреНрд╖реЗрдкрдг</h1>
<p>рд╡рд╛рд░реНрд╖рд┐рдХ рдкрд░рд┐рд╡рд░реНрддрди рджрд░ рд╕рд╣рд┐рдд Payback Period рддрдерд╛ ROI</p>
</header>

<main>

<h2>ЁЯФв рдЖрдзрд╛рд░рднреВрдд рдЗрдирдкреБрдЯ</h2>

<label>рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рд▓рдЧрд╛рдиреА (рд░реБ.)</label><br>
<input type="number" id="investment" placeholder="рдЬрд╕реНрддреИ: 5000000" oninput="calculate()" />

<h3>ЁЯУИ рд╡рд╛рд░реНрд╖рд┐рдХ рдкрд░рд┐рд╡рд░реНрддрди рджрд░</h3>

<label>рд╡рд╛рд░реНрд╖рд┐рдХ рдЦрд░реНрдЪ рд╡реГрджреНрдзрд┐ (%)</label><br>
<input type="number" id="expGrowth" value="5" oninput="calculate()" />

<br><br>

<label>рд╡рд╛рд░реНрд╖рд┐рдХ рдЖрдореНрджрд╛рдиреА рд╡реГрджреНрдзрд┐ (%)</label><br>
<input type="number" id="incGrowth" value="10" oninput="calculate()" />

<p class="footer-note">
Year-1 рдХреЛ рдЦрд░реНрдЪ рд░ рдЖрдореНрджрд╛рдиреА рдкреНрд░рдгрд╛рд▓реАрдмрд╛рдЯ рд╕реНрд╡рддрдГ рд▓рд┐рдЗрдиреНрдЫред
</p>

<h2>ЁЯУК рел рд╡рд░реНрд╖реЗ рдирдЧрдж рдкреНрд░рд╡рд╛рд╣ (Cash Flow Projection)</h2>

<table>
<thead>
<tr>
  <th>рд╡рд░реНрд╖</th>
  <th>рд╡рд╛рд░реНрд╖рд┐рдХ рдЖрдореНрджрд╛рдиреА (рд░реБ.)</th>
  <th>рд╡рд╛рд░реНрд╖рд┐рдХ рдЦрд░реНрдЪ (рд░реБ.)</th>
  <th>рд╡рд╛рд░реНрд╖рд┐рдХ рдирд╛рдлрд╛ (рд░реБ.)</th>
  <th>рд╕рдВрдЪрд┐рдд рдирдЧрдж рдкреНрд░рд╡рд╛рд╣ (рд░реБ.)</th>
</tr>
</thead>
<tbody id="projectionBody"></tbody>
</table>

<h2>ЁЯУИ рд▓рдЧрд╛рдиреА рдкреНрд░рддрд┐рдлрд▓ рд╡рд┐рд╢реНрд▓реЗрд╖рдг</h2>

<table>
<tr>
  <td class="left highlight">рдХреБрд▓ рел рд╡рд░реНрд╖рдХреЛ рдирд╛рдлрд╛</td>
  <td class="highlight">рд░реБ. <span id="totalProfit">0</span></td>
</tr>
<tr>
  <td class="left highlight">Payback Period</td>
  <td class="highlight"><span id="payback">тАФ</span></td>
</tr>
<tr>
  <td class="left highlight">ROI (%)</td>
  <td class="highlight"><span id="roi">тАФ</span></td>
</tr>
</table>

<div class="note" id="analysisText"></div>

<!-- Debug (optional) -->
<div class="footer-note">
<strong>Debug:</strong>
Expense=<span id="dExp"></span> |
Income=<span id="dInc"></span>
</div>

</main>

<footer>
┬й farmerbase BPMS | 5-Year Projection & ROI (Final)
</footer>

<script>
function calculate(){

  let baseExpense = Number(localStorage.getItem("totalExpense")) || 0;
  let baseIncome  = Number(localStorage.getItem("totalIncome")) || 0;

  let expGrowth = Number(document.getElementById("expGrowth").value) || 0;
  let incGrowth = Number(document.getElementById("incGrowth").value) || 0;
  let invest    = Number(document.getElementById("investment").value) || 0;

  document.getElementById("dExp").innerText = baseExpense;
  document.getElementById("dInc").innerText = baseIncome;

  let body = document.getElementById("projectionBody");
  body.innerHTML = "";

  let curExpense = baseExpense;
  let curIncome  = baseIncome;

  let cumulative = -invest;
  let totalProfit = 0;
  let paybackYear = "рдирднрдПрдХреЛ";

  for(let y=1; y<=5; y++){

    if(y > 1){
      curExpense = curExpense * (1 + expGrowth/100);
      curIncome  = curIncome  * (1 + incGrowth/100);
    }

    let yearlyProfit = curIncome - curExpense;
    cumulative += yearlyProfit;
    totalProfit += yearlyProfit;

    if(cumulative >= 0 && paybackYear === "рдирднрдПрдХреЛ"){
      paybackYear = "рд╡рд░реНрд╖ " + y;
    }

    body.innerHTML += `
      <tr>
        <td class="left">рд╡рд░реНрд╖ ${y}</td>
        <td>${Math.round(curIncome).toLocaleString()}</td>
        <td>${Math.round(curExpense).toLocaleString()}</td>
        <td>${Math.round(yearlyProfit).toLocaleString()}</td>
        <td>${Math.round(cumulative).toLocaleString()}</td>
      </tr>
    `;
  }

  document.getElementById("totalProfit").innerText =
    Math.round(totalProfit).toLocaleString();

  document.getElementById("payback").innerText = paybackYear;

  if(invest > 0){
    let roi = (totalProfit / invest) * 100;
    document.getElementById("roi").innerText =
      roi.toFixed(2) + " %";
  }else{
    document.getElementById("roi").innerText = "тАФ";
  }

  document.getElementById("analysisText").innerText =
    `рд╡реНрдпрд╡рд╕рд╛рдпрдХреЛ рдкрд╣рд┐рд▓реЛ рд╡рд░реНрд╖рдХреЛ рдЦрд░реНрдЪ рддрдерд╛ рдЖрдореНрджрд╛рдиреАрд▓рд╛рдИ рдЖрдзрд╛рд░ рдорд╛рдиреА
     рд╡рд╛рд░реНрд╖рд┐рдХ рдЦрд░реНрдЪрдорд╛ ${expGrowth}% рд░ рдЖрдореНрджрд╛рдиреАрдорд╛ ${incGrowth}% рдкрд░рд┐рд╡рд░реНрддрди
     рд╣реБрдиреЗ рдорд╛рдиреНрдпрддрд╛рдХрд╛ рд╕рд╛рде рел рд╡рд░реНрд╖реЗ рд╡рд┐рддреНрддреАрдп рдкреНрд░рдХреНрд╖реЗрдкрдг рдЧрд░рд┐рдПрдХреЛ рдЫред
     рдпрд╕ рдЕрд╡рдзрд┐рдорд╛ рдХреБрд▓ рд░реБ. ${Math.round(totalProfit).toLocaleString()}
     рдирд╛рдлрд╛ рдЖрд░реНрдЬрди рд╣реБрдиреЗ, рдкреНрд░рд╛рд░рдореНрднрд┐рдХ рд▓рдЧрд╛рдиреАрдХреЛ Payback ${paybackYear} рдорд╛
     рд╣реБрдиреЗ рддрдерд╛ рдХреБрд▓ ROI ${invest>0 ? ((totalProfit/invest)*100).toFixed(2) : 0}% рд░рд╣рдиреЗ
     рджреЗрдЦрд┐рдиреНрдЫред`;
}

window.onload = calculate;
</script>

</body>
</html>
