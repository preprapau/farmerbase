<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Project Cover | Business Plan</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
  font-family:"Noto Sans Devanagari","Kalimati","Mangal","Nirmala UI",system-ui,Arial;
  background:#f4f7f6;
  margin:0;
}

/* ===== HEADER ===== */
header{
  background:#2e7d32;
  color:#fff;
  padding:20px;
}
nav a{
  color:#fff;
  text-decoration:none;
  margin-right:12px;
  font-weight:600;
}
.project-bar{
  margin-top:10px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.project-bar input,.project-bar select{
  padding:6px;font-family:inherit;
}
.project-bar button{
  padding:6px 12px;
  background:#1b5e20;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
}

/* ===== COVER ===== */
.cover{
  max-width:900px;
  margin:30px auto;
  background:#fff;
  padding:50px 40px;
  border-radius:10px;
  text-align:center;
}
.cover h1{
  font-size:32px;
}
.icon{
  font-size:90px;
  margin:30px 0;
}
.desc{
  font-size:18px;
  margin-bottom:25px;
}
.map{
  margin-top:25px;
}
.footer{
  margin-top:35px;
  border-top:1px solid #ddd;
  padding-top:15px;
  font-size:15px;
}

/* ===== POPUP ===== */
.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  z-index:999;
}
.modal-box{
  background:#fff;
  max-width:800px;
  margin:5% auto;
  padding:25px;
  border-radius:10px;
}
.close{
  float:right;
  cursor:pointer;
  font-weight:700;
}

/* ===== PRINT ===== */
@media print{
  header,.no-print,.modal{display:none!important}
  body{background:#fff}
  .cover{margin:0;padding:0;border-radius:0}
}
</style>
</head>

<body>

<!-- ===== HEADER (SCREEN ONLY) ===== -->
<header class="no-print">
  <h2>üåæ Business Plan Management System</h2>

  <nav>
    <a href="index.html">üè† Home</a>
    <a href="#" onclick="openModal()">‚ÑπÔ∏è ‡§Ö‡§π‡§ø‡§≤‡•á‡§ï‡§æ ‡§∏‡•Ç‡§ö‡§®‡§æ</a>
    <a href="short-info.html">‚úèÔ∏è Edit Info</a>
    <a href="full-proposal.html">üßæ Full Proposal</a>
  </nav>

  <div class="project-bar">
    <input id="projectName" placeholder="Project ‡§®‡§æ‡§Æ">
    <button onclick="saveProject()">üíæ Save</button>
    <select id="projectList" onchange="loadProject()">
      <option value="">üìÇ Load Project</option>
    </select>
    <button onclick="window.print()">üñ®Ô∏è Print Cover</button>
  </div>
</header>

<!-- ===== COVER ===== -->
<div class="cover">
  <h1 id="bizName">‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ï‡•ã ‡§®‡§æ‡§Æ</h1>

  <div class="icon" id="bizIcon">üåæ</div>

  <div class="desc" id="bizDesc">
    ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§™‡•ç‡§∞‡§ï‡•É‡§§‡§ø / ‡§µ‡§∞‡•ç‡§£‡§®
  </div>

  <div class="map no-print">
    <iframe id="gmap" width="100%" height="250" style="border:0"
      loading="lazy" allowfullscreen></iframe>
  </div>

  <div class="footer">
    <div id="orgName"></div>
    <div id="bizLocation"></div>
  </div>
</div>

<!-- ===== POPUP ===== -->
<div class="modal no-print" id="infoModal">
  <div class="modal-box">
    <span class="close" onclick="closeModal()">‚úñ</span>
    <h3>üìä ‡§Ö‡§π‡§ø‡§≤‡•á‡§ï‡•ã ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂</h3>
    <div id="popupContent"></div>
  </div>
</div>

<script>
/* ICON */
function getIcon(t){
  t=(t||"").toLowerCase();
  if(t.includes("‡§¨‡§Ç‡§ó‡•Å‡§∞")||t.includes("pig"))return"üêñ";
  if(t.includes("‡§¨‡§æ‡§ñ‡•ç‡§∞‡§æ")||t.includes("goat"))return"üêê";
  if(t.includes("‡§ó‡§æ‡§à"))return"üêÑ";
  if(t.includes("‡§§‡§∞‡§ï‡§æ‡§∞‡•Ä"))return"ü•¨";
  return"üåæ";
}

/* LOAD COVER */
function loadCover(){
  let s=JSON.parse(localStorage.getItem("shortInfo")||"{}");
  bizName.innerText=s.bp_name||"‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ï‡•ã ‡§®‡§æ‡§Æ";
  bizDesc.innerText=s.bp_products||"‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§™‡•ç‡§∞‡§ï‡•É‡§§‡§ø / ‡§µ‡§∞‡•ç‡§£‡§®";
  orgName.innerText=s.bp_org||s.bp_owner||"";
  bizLocation.innerText=s.bp_location||"";
  bizIcon.innerText=getIcon(s.bp_products);

  if(s.bp_location){
    gmap.src="https://www.google.com/maps?q="+
      encodeURIComponent(s.bp_location)+"&output=embed";
  }

  popupContent.innerHTML=`
    <p><strong>‡§ï‡•Å‡§≤ ‡§ñ‡§∞‡•ç‡§ö:</strong> ‡§∞‡•Å. ${localStorage.totalExpense||0}</p>
    <p><strong>‡§ï‡•Å‡§≤ ‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä:</strong> ‡§∞‡•Å. ${localStorage.totalIncome||0}</p>
    <p><strong>ROI:</strong> ${localStorage.roi||""}%</p>
    <p><strong>Payback:</strong> ${localStorage.payback||""}</p>
  `;
}

/* MODAL */
function openModal(){infoModal.style.display="block";}
function closeModal(){infoModal.style.display="none";}

/* PROJECT SAVE / LOAD */
function saveProject(){
  let n=projectName.value.trim();
  if(!n){alert("Project ‡§®‡§æ‡§Æ ‡§≤‡•á‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç");return;}
  let d={
    shortInfo:JSON.parse(localStorage.shortInfo||"{}"),
    businessDetail:JSON.parse(localStorage.businessDetail||"[]"),
    expenseData:JSON.parse(localStorage.expenseData||"[]"),
    incomeData:JSON.parse(localStorage.incomeData||"[]"),
    totalExpense:localStorage.totalExpense||0,
    totalIncome:localStorage.totalIncome||0,
    roi:localStorage.roi||"",
    payback:localStorage.payback||""
  };
  localStorage.setItem("project_"+n,JSON.stringify(d));
  refreshProjects();alert("Project Save ‡§≠‡§Ø‡•ã");
}
function loadProject(){
  let k=projectList.value;
  if(!k)return;
  let d=JSON.parse(localStorage.getItem(k));
  if(!d)return;
  for(let key in d)
    localStorage.setItem(key,JSON.stringify(d[key]));
  loadCover();alert("Project Load ‡§≠‡§Ø‡•ã");
}
function refreshProjects(){
  projectList.innerHTML='<option value="">üìÇ Load Project</option>';
  for(let k in localStorage)
    if(k.startsWith("project_")){
      let o=document.createElement("option");
      o.value=k;o.text=k.replace("project_","");
      projectList.appendChild(o);
    }
}
window.onload=function(){
  refreshProjects();
  loadCover();
};
</script>

</body>
</html>
